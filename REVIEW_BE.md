# Backend Review

[Security]
- [CRITICAL] Authn/z effectively disabled: all routes permitAll, so SecurityContext is never enforced. See `back-end/src/main/java/com/apple/shop/SecurityConfig.java:60`.
- [CRITICAL] IDOR on address APIs: client-supplied memberId/addressIdx is used for read/update/delete without ownership checks. See `back-end/src/main/java/com/apple/shop/address/AddressController.java:32`, `back-end/src/main/java/com/apple/shop/address/AddressController.java:49`, `back-end/src/main/java/com/apple/shop/address/AddressController.java:78`, `back-end/src/main/java/com/apple/shop/address/AddressController.java:85`, `back-end/src/main/java/com/apple/shop/address/AddressController.java:106`.
- [HIGH] Business member endpoints have no role/ownership enforcement and login does not mint a token/session; combined with permitAll this makes the area unauthenticated. See `back-end/src/main/java/com/apple/shop/storeMember/StoreMemberController.java:23`, `back-end/src/main/java/com/apple/shop/storeMember/StoreMemberController.java:33`, `back-end/src/main/java/com/apple/shop/storeMember/StoreMemberController.java:54`, `back-end/src/main/java/com/apple/shop/SecurityConfig.java:60`.
- [HIGH] Sensitive data logged to stdout: plaintext credentials, auth header, and JWT tokens are printed. See `back-end/src/main/java/com/apple/shop/member/jwt/LoginFilter.java:36`, `back-end/src/main/java/com/apple/shop/member/jwt/LoginFilter.java:63`, `back-end/src/main/java/com/apple/shop/member/jwt/JWTFilter.java:27`, `back-end/src/main/java/com/apple/shop/member/MemberService.java:52`.
- [MEDIUM] SQL injection risk appears low from scan (no @Query/nativeQuery/EntityManager/JDBC usage found), but keep input validation for repository-driven queries.
- [MEDIUM] SQL logging enabled in prod profile; may leak PII into logs. See `back-end/src/main/resources/application.yml:21`.


[Readability]
- Split-first (>20 lines): `back-end/src/main/java/com/apple/shop/member/jwt/JWTFilter.java:23` (doFilterInternal, ~53 lines), `back-end/src/main/java/com/apple/shop/SecurityConfig.java:43` (filterChain, ~35), `back-end/src/main/java/com/apple/shop/address/AddressController.java:50` (addAddress, ~27), `back-end/src/main/java/com/apple/shop/store/StoreController.java:44` (getStoreListByStoreIdx, ~28), `back-end/src/main/java/com/apple/shop/item/ItemController.java:24` (mainProduct, ~29), `back-end/src/main/java/com/apple/shop/store/StoreController.java:19` (getStoreList, ~23), `back-end/src/main/java/com/apple/shop/common/lock/DistributedLockAop.java:25` (lock, ~27), `back-end/src/main/java/com/apple/shop/member/MemberService.java:19` (registerMember, ~25), `back-end/src/main/java/com/apple/shop/member/jwt/LoginFilter.java:25` (attemptAuthentication, ~21).
- Mixed abstraction: request parsing + validation + auth context assembly in `back-end/src/main/java/com/apple/shop/member/jwt/JWTFilter.java:23`; config + filter wiring + commented access rules in `back-end/src/main/java/com/apple/shop/SecurityConfig.java:43`; DTO mapping + logging + repository access in `back-end/src/main/java/com/apple/shop/item/ItemController.java:24` and `back-end/src/main/java/com/apple/shop/store/StoreController.java:19`; lock key composition + acquisition + business proceed + unlock handling in `back-end/src/main/java/com/apple/shop/common/lock/DistributedLockAop.java:25`.
- Ambiguous naming: `addAddress1` reads like a temp method, not intent-revealing (`back-end/src/main/java/com/apple/shop/address/AddressController.java:86`); `mainProduct`/`mainShop` do not convey route intent (`back-end/src/main/java/com/apple/shop/item/ItemController.java:24`, `back-end/src/main/java/com/apple/shop/item/ItemController.java:55`); `getStoreListByStoreIdx` returns a single store, not a list (`back-end/src/main/java/com/apple/shop/store/StoreController.java:44`); `List<Item> List` shadows the type name and hides meaning (`back-end/src/main/java/com/apple/shop/item/ItemController.java:57`).


[Testing]
- Coverage gap: only `contextLoads` exists; no unit tests for core business services (member/storeMember/item/order/cart/address/review) or security/JWT flows. See `back-end/src/test/java/com/apple/shop/ShopApplicationTests.java:1`.
- Reliability risk: critical paths (login/signup, order creation, stock handling, payments, address updates) are unverified; regressions will slip without service-level tests (e.g., `back-end/src/main/java/com/apple/shop/member/MemberService.java:19`, `back-end/src/main/java/com/apple/shop/storeMember/StoreMemberService.java:17`, `back-end/src/main/java/com/apple/shop/orders/OrdersService.java:1`).
- Test readability/value: current test asserts nothing and provides no behavior signal; replace with focused unit tests + a small set of controller/endpoint tests.


[Performance]
- Hypothesis: Unpaginated list endpoints will degrade linearly with data volume; `findAllByType`, `findAllByStoreIdx`, `findAllByMemberIdx` return full sets and build DTOs in-memory, so 1,000 concurrent users + large tables can drive high DB load and GC pressure. See `back-end/src/main/java/com/apple/shop/store/StoreController.java:19`, `back-end/src/main/java/com/apple/shop/item/ItemController.java:24`, `back-end/src/main/java/com/apple/shop/review/ReviewController.java:19`, `back-end/src/main/java/com/apple/shop/orders/OrdersController.java:22`.
- Hypothesis: JPA default selects will fetch large LOB/text columns (e.g., store info) even when not used in list responses; as store count grows this amplifies I/O and serialization time under load. See `back-end/src/main/java/com/apple/shop/store/Store.java:48`, `back-end/src/main/java/com/apple/shop/store/StoreRepository.java:11`, `back-end/src/main/java/com/apple/shop/store/StoreController.java:19`.
- Hypothesis: Per-request console logging of full lists/DTOs adds synchronous I/O and lock contention; under load it will inflate response times and CPU usage. See `back-end/src/main/java/com/apple/shop/store/StoreController.java:19`, `back-end/src/main/java/com/apple/shop/item/ItemController.java:24`, `back-end/src/main/java/com/apple/shop/review/ReviewController.java:19`, `back-end/src/main/java/com/apple/shop/orders/OrdersController.java:22`.
- Hypothesis: JWT filter logs every request and does per-request token parsing; under high QPS this adds overhead and may become a bottleneck if coupled with stdout logging. See `back-end/src/main/java/com/apple/shop/member/jwt/JWTFilter.java:23`.
